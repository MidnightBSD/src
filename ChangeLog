2013-03-24  Jim Meyering  <meyering@fb.com>

	version 3.3
	* NEWS: Record release date.

2013-03-23  Paul Eggert  <eggert@cs.ucla.edu>

	doc: fix menu typo
	* doc/diffutils.texi (Comparing Three Files): Fix out-of-order menu.
	Bug caught by Texinfo 5.0.

	maint: update build procedure to recent gettext etc.
	* bootstrap.conf (gnulib_modules): Add vararrays.
	(needed_gnulib_files, unnecessary_gettext_files): New vars.
	(bootstrap_post_import_hook): New function, to implement these vars.
	(excluded_files): Remove; 'bootstrap' no longer supports this.
	Its function is now performed by unnecessary_gettext_files.
	(buildreq): Update automake to 1.12.2, to avoid CVE-2012-3386.
	* configure.ac (AM_GNU_GETTEXT_VERSION): Bump from 0.17 to 0.18.2,
	to lessen the probability that we'll have outlandishly old files
	during a build.
	* m4/vararrays.m4: Remove from repository, as we now use the
	gnulib version.

2013-03-21  Jim Meyering  <jim@meyering.net>

	build: update gnulib to latest and adapt; update bootstrap, too
	Blindly updating to the latest from gnulib, bootstrap would
	fail due to failure of our local patches to apply.  Hence,
	these first two updates.
	* gl/lib/regex_internal.c.diff: Update offsets, so this patch
	applies to the latest from gnulib.
	* gl/lib/regex_internal.h.diff: Remove file.  No longer needed.
	* bootstrap: Update from gnulib.

2013-01-06  Paul Eggert  <eggert@cs.ucla.edu>

	tests: port to hosts lacking fmt, make -C
	* tests/Makefile.am (built_programs): Don't assume fmt works.
	Don't rely on 'make -C', either.

	maint: update .gitignore for recent gnulib
	* .gitignore: Add tests/*.trs and several *.h and *.sed files in lib,

2013-01-04  Jim Meyering  <jim@meyering.net>

	build: update gnulib submodule to latest

	maint: update all copyright year number ranges
	Run "make update-copyright".

2012-10-23  Eric Blake  <eblake@redhat.com>

	build: default to --enable-gcc-warnings in a git tree
	Anyone building from cloned sources can be assumed to have a new
	enough environment, such that enabling gcc warnings by default will
	be useful.  Tarballs still default to no warnings, and the default
	can still be overridden with --disable-gcc-warnings.
	* configure.ac (gl_gcc_warnings): Set default based on environment.

2012-10-03  Paul Eggert  <eggert@cs.ucla.edu>

	* doc/diffutils.texi (cmp Options): Document -l format better.

2012-09-10  Jim Meyering  <meyering@redhat.com>

	maint: use xasprintf in place of xmalloc+sprintf
	* bootstrap.conf (gnulib_modules): Add gnulib's xvasprintf module.
	* src/util.c: Include "xvasprintf.h".
	(begin_output): Use xasprintf in place of xmalloc+sprintf.

2012-09-10  Andreas Gruenbacher  <agruen@gnu.org>

	diff: encode file names with special characters
	* src/util.c (c_escape_char): New function.
	(c_escape): New function.
	(begin_output): Escape file names when needed.
	* src/context.c (print_context_header): New names parameter.
	(print_context_label): New name parameter.
	* src/diff.h (print_context_header): Change prototype.
	* tests/filename-quoting: New file.
	* NEWS: Document this change.

2012-08-30  Paul Eggert  <eggert@cs.ucla.edu>

	diff: silence GCC warning instead of slowing down
	* src/dir.c (find_dir_file_pathname): Use 'IF_LINT (volatile)' to
	silence the gcc warning, rather than using 'volatile', as the
	warning appears to be bogus.

2012-08-28  Jim Meyering  <meyering@redhat.com>

	diff: avoid possible longjmp-triggered misbehavior
	* src/dir.c (find_dir_file_pathname): gcc 4.8.0 20120825 reported
	that a local variable's value might be clobbered.  Declare "match"
	to be volatile.

	build: update gnulib, bootstrap and init.sh to latest

	maint: avoid new syntax-check failure due to @xref use
	* doc/diffutils.texi: Change several "; @xref{..." to ".  @xref{...",
	since @xref should start a sentence.

2012-05-15  Paul Eggert  <eggert@cs.ucla.edu>

	maint: remove ms subdirectory
	diffutils is now designed to build with Cygwin or MinGW.
	The old DJGPP stuff probably doesn't work anyway.
	* Makefile.am (SUBDIRS): Remove ms.
	* NEWS: Document this.
	* configure.ac (AC_CONFIG_FILES): Remove ms/Makefile.
	* ms/Makefile.am, ms/README, ms/config.bat, ms/config.sed:
	* ms/config.site: Remove.

2012-05-14  Paul Eggert  <eggert@cs.ucla.edu>

	maint: update bootstrap from gnulib
	* bootstrap: Update from gnulib.

	main: port subcommands to mingw
	Problem reported by Eli Zaretskii in
	<http://lists.gnu.org/archive/html/bug-gnu-utils/2012-05/msg00013.html>.
	Approach suggested by Bruno Haible as option (4) in
	<http://lists.gnu.org/archive/html/bug-gnu-utils/2012-05/msg00036.html>.
	* bootstrap.conf (gnulib_modules): Add system-quote.
	* src/diff3.c, src/sdiff.c, src/util.c:
	Include <system-quote.h>, not <sh-quote.h>.
	* src/diff3.c (read_diff):
	* src/sdiff.c (main, edit):
	* src/util.c (begin_output):
	Use system_quote_argv, for portability to Mingw.
	* src/sdiff.c (NUM_SIGS, handler_index_of_SIGINT): Now enum
	values, not macros; this is cleaner and avoids a GCC warning if
	!HAVE_WORKING_VFORK.
	* src/util.c (begin_output) [! HAVE_WORKING_FORK]: Do not use -f,
	for consistency with the HAVE_WORKING_FORK code.

	maint: update bootstrap from gnulib
	* bootstrap: Update from gnulib.

	maint: m4/gnulib-cache.m4 is not under version control
	This is like what coreutils does, and suppresses 'git status' chatter.
	* .gitignore: Add /m4/gnulib-cache.m4.

	Use binary mode when testing for binary files.
	This reverts the 2006-01-05 change and modernizes to the current API.
	Idea suggested by Eli Zaretskii in:
	http://lists.gnu.org/archive/html/bug-gnu-utils/2012-05/msg00066.html
	* src/cmp.c (main):
	* src/diff.c (main, compare_files):
	Use set_binary_mode rather than SET_BINARY.
	* src/diff.c (compare_files): Omit unnecessary use of O_BINARY.
	* src/io.c (sip): Sample unknown files in binary mode, to see
	whether they are binary.
	(read_files): Read binary files in binary mode.

	build: update gnulib submodule to latest

2012-05-13  Stefano Lattarini  <stefano.lattarini@gmail.com>

	build: omit obsolete AM_PROG_CC_STDC macro
	The Automake-provided macro 'AM_PROG_CC_STDC' has been superseded by
	the Autoconf-provided one 'AC_PROG_CC' since October 2002, and will
	be removed in the next major automake version.
	* configure.ac (AM_PROG_CC_STDC): Drop it.

2012-05-05  Jim Meyering  <meyering@redhat.com>

	diff: fix a typo that was always disabling the same_special_file macro
	* src/system.h (same_special_file): Correct cpp guard expression:
	s/HAVE_ST_RDEV/HAVE_STRUCT_STAT_ST_RDEV/.  Reported by Eli Zaretskii.

2012-04-17  Jim Meyering  <meyering@redhat.com>

	maint: update bootstrap from gnulib
	* bootstrap: Update from gnulib.

2012-03-07  Eric Blake  <eblake@redhat.com>

	usage: improve wording of --ignore-matching-lines
	* src/diff.c (option_help_msgid): Tweak wording.

2012-03-04  Paul Eggert  <eggert@cs.ucla.edu>

	doc: explain -I RE better in --help output
	* src/diff.c, src/sdiff.c (option_help_msgid): For -I RE,
	change "whose lines all match" to "all whose lines match" to avoid
	unintended interpretation.  Reported by Danijel Tasov in
	<http://bugs.debian.org/648411>.

2012-02-12  Paul Eggert  <eggert@cs.ucla.edu>

	sdiff: remove dependency on sigprocmask
	* bootstrap.conf (gnulib_modules): Remove sigprocmask.
	* src/sdiff.c (temporary_file): No need to invoke sigprocmask
	here, since the signal handler merely sets a flag.

2012-02-04  Paul Eggert  <eggert@cs.ucla.edu>

	diff: -N, --unidirectional-new-file now compare to "-" too
	* NEWS: Document this.
	* doc/diffutils.texi (Comparing Directories): Likewise.
	Also, document that these options work at the top level.
	* src/diff.c (compare_files): Treat EBADF like ENOENT, to handle
	the case where "-" is closed.  Allow the other file to be
	STDIN_FILENO, in case it's "-".
	* tests/Makefile.am (TESTS): Add new-file.
	* tests/new-file: New file.

2012-01-25  Paul Eggert  <eggert@cs.ucla.edu>

	maint: quote 'like this' or "like this", not `like this'
	This is in response to a recent change in the GNU coding standards,
	which now suggest quoting 'like this' or "like this", instead of
	`like this' or ``like this''.
	* HACKING, NEWS, README, README-hacking, TODO, doc/diagmeet.note:
	* doc/diffutils.texi, ms/config.bat, ms/config.site:
	* src/analyze.c, src/cmp.c, src/context.c, src/diff.c:
	* src/diff.h, src/diff3.c, src/dir.c, src/ifdef.c, src/io.c:
	* src/sdiff.c, src/side.c, src/system.h, src/util.c:
	* tests/help-version:
	Quote 'like this' or "like this" in commentary.
	* cfg.mk (old_NEWS_hash): Adjust to reflect new NEWS quoting.
	* man/help2man: Update to 1.40.4 version, with quoting fixed as above.
	* po/en.po: Remove translation involving `, as it's no longer needed.
	* src/cmp.c (try_help, specify_ignore_initial, usage, main):
	* src/diff.c (main, try_help, option_help_msgid, specify_value)
	(compare_files):
	* src/diff3.c (main, try_help, option_help_msgid, usage)
	(read_diff):
	* src/dir.c (compare_names):
	* src/sdiff.c (try_help, usage, check_child_status, main):
	* src/util.c (finish_output):
	* tests/help-version:
	Quote 'like this' in output.

	build: update gnulib submodule to latest

2012-01-12  Jim Meyering  <meyering@redhat.com>

	build: accommodate newer bootstrap from gnulib
	* bootstrap.conf (gnulib_tool_option_extras): Add both --symlink
	and --makefile-name=gnulib.mk.  Also remove now-obsolete $bt/ prefix.
	* bootstrap: Update from gnulib.
	* tests/init.sh: Update from gnulib.
	* lib/Makefile.am: Initialize numerous variables, so that
	generated code in gnulib.mk may use += to append to them.

	maint: avoid new syntax-check failure
	* src/diff.c (compare_files): Use STREQ, not strcmp.

2012-01-08  Bruno Haible  <bruno@clisp.org>

	New option --no-dereference.
	* src/diff.h (no_dereference_symlinks): New variable.
	* src/diff.c: Include xreadlink.h.
	(longopts): Add --no-dereference option.
	(main): Accept --no-dereference option.
	(option_help_msgid): Mention the --no-dereference option.
	(compare_files): If no_dereference_symlinks is true, use lstat()
	instead of stat(). Compare symbolic links by comparing their values.
	* bootstrap.conf (gnulib_modules): Add lstat, stat, xreadlink.
	* doc/diffutils.texi (Comparing Directories, diff Options): Mention the
	--no-dereference option.
	* tests/no-dereference: New file.
	* tests/Makefile.am (TESTS): Add it.

2012-01-01  Jim Meyering  <meyering@redhat.com>

	maint: update all copyright year number ranges
	Run "make update-copyright".

2011-12-14  Jim Meyering  <meyering@redhat.com>

	build: update to latest gnulib and adapt
	* tests/binary: Reverse arguments to compare to avoid failure of
	new syntax-check rule.
	* configure.ac: Use -Wno-format-nonliteral.
	Mark functions as pure of const, per recommendations enabled by
	new gcc -W options.  Use _GL_ATTRIBUTE_PURE and _GL_ATTRIBUTE_CONST.
	* lib/cmpbuf.h (buffer_lcm, block_compare):
	Apply pure and/or const attributes.
	* src/cmp.c (block_compare): Likewise.
	* src/context.c (find_hunk): Likewise.
	* src/diff.h (lines_differ): Likewise.
	* src/diff3.c (skipwhite): Likewise.
	* src/dir.c (dir_loop): Likewise.
	* src/util.c (find_change, find_reverse_change): Likewise.
	(translate_line_number): Likewise.

	build: stop distributing gzip'd releases;  xz is enough
	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist-gzip.

2011-11-29  Jim Meyering  <meyering@redhat.com>

	tests: use "compare exp out", not "compare out exp"
	Likewise, when an empty file is expected, use "compare /dev/null out",
	not "compare out /dev/null". I.e., specify the expected/desired contents
	via the first file name.  Prompted by a suggestion from Bruno Haible
	in http://thread.gmane.org/gmane.comp.gnu.grep.bugs/4020/focus=29154

	Run these commands:

	  git grep -l -E 'compare [^ ]+ exp' \
	    |xargs perl -pi -e 's/\b(compare) (\S+) (exp\S*)/$1 $3 $2/'
	  git grep -l -E 'compare [^ ]+ /dev/null' \
	    |xargs perl -pi -e 's,\b(compare) (\S+) (/dev/null),$1 $3 $2,'

	But manually convert this one:

	  -compare out exp-$(echo $opt|tr ' ' _)
	  +compare exp-$(echo $opt|tr ' ' _) out

	and avoid an inappropriate change to cfg.mk.

2011-10-12  Stefano Lattarini  <stefano.lattarini@gmail.com>

	tests: use more portable fd redirection in TESTS_ENVIRONMENT
	* tests/Makefile.am (TESTS_ENVIRONMENT): Redirection with `exec 9>&2'
	is not portable to various Korn shells, and to (at least) HP-UX 11
	/bin/sh.  Use a more portable idiom.
	See http://thread.gmane.org/gmane.comp.gnu.coreutils.bugs/22488 for
	lots of discussion.

2011-10-11  Stefano Lattarini  <stefano.lattarini@gmail.com>

	tests: make test runner a script, not a shell function
	All the test scripts in the diffutils testsuite are shell scripts,
	so the current definition of TESTS_ENVIRONMENT, which adaptively
	run tests using either perl or the shell depending on their kind,
	is an overkill.

	Moreover, this change is required in order for the testsuite to
	continue to work with the new testsuite harness that is planned
	to be introduced in Automake 1.12 (which, as of the writing date,
	is still under development and in late alpha state).

	See also related discussion on bug-coreutils:
	 <http://debbugs.gnu.org/cgi/bugreport.cgi?bug=8887>

	* tests/Makefile.am (TESTS_ENVIRONMENT): Remove definition of the
	`shell_or_perl_' shell function, which is not required anymore.
	(LOG_COMPILER): New, define to `$(SHELL)'.
	* tests/binary: Make executable.
	* tests/colliding-file-names: Likewise.
	* tests/excess-slash: Likewise.
	* tests/no-newline-at-eof: Likewise.

2011-10-04  Claudio Bley  <claudio.bley@gmail.com>

	portability: use SET_BINARY rather than xfreopen (NULL, ...
	* src/diff.c: Include binary-io.h, not xfreopen.h.
	(main): Use SET_BINARY (...) rather than xfreopen (NULL, X, ...),
	because the latter doesn't work on MinGW and crashes using MSVC.
	* src/cmp.c (main): Likewise.

2011-10-04  Jim Meyering  <meyering@redhat.com>

	build: update gnulib submodule to latest

2011-09-02  Jim Meyering  <meyering@redhat.com>

	post-release administrivia
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* cfg.mk (old_NEWS_hash): Auto-update.

	version 3.2
	* NEWS: Record release date.

	build: update bootstrap and tests/init.sh from gnulib
	* bootstrap: Update from gnulib.
	* tests/init.sh: Likewise.

	build: update gnulib submodule to latest

2011-09-01  Jim Meyering  <meyering@redhat.com>

	doc: diffutils' texi-derived doc may now be in debian's "main" section
	* NEWS (Packaging): Mention the "no front/back-cover" change.

2011-08-14  Jim Meyering  <meyering@redhat.com>

	maint: avoid new "make sytnax-check" failure.
	* src/diff.h (find_dir_file_pathname): Mark declaration with "extern"
	keyword, in order to placate the tight-scope syntax check.

2011-08-14  Paul Eggert  <eggert@cs.ucla.edu>

	* src/io.c (find_and_hash_each_line): Refactor for brevity.

2011-08-14  Roland McGrath  <roland@hack.frob.com>

	diff, sdiff: new option --ignore-trailing-space (-Z)
	Derived from Roland McGrath's patch (dated June 2004!) in:
	http://lists.gnu.org/archive/html/bug-gnu-utils/2004-07/msg00000.html
	* NEWS:
	* doc/diffutils.texi (White Space, Blank Lines)
	(sdiff Option Summary, diff Options, sdiff Options): Document -Z.
	* src/diff.h (IGNORE_TRAILING_SPACE)
	(IGNORE_TAB_EXPANSION_AND_TRAILING_SPACE): New constants, for -Z.
	* src/diff.c (shortopts, longopts, main, option_help_msgid):
	* src/sdiff.c (longopts, option_help_msgid, main):
	* src/io.c (find_and_hash_each_line):
	* src/util.c (lines_differ, analyze_hunk): Support -Z.

2011-08-13  Paul Eggert  <eggert@cs.ucla.edu>

	* bootstrap.conf (gnulib_modules): Remove timegm.
	This fixes a problem noted by Andreas Schwab in:
	http://lists.gnu.org/archive/html/bug-diffutils/2011-08/msg00035.html

2011-08-13  Tim Waugh  <twaugh@redhat.com>

	diff: --ignore-file-name-case now applies at top level too
	Derived from Tim Waugh's patch in:
	http://lists.gnu.org/archive/html/bug-diffutils/2011-08/msg00034.html
	* NEWS, doc/diffutils.texi (diff Options): Document this.
	* src/diff.c (compare_files): Implement this, by using
	find_dir_file_pathname.
	* src/diff.h (find_dir_file_pathname): New decl.
	* src/dir.c: Include filenamecat.h.
	(find_dir_file_pathname): New function.

2011-08-13  Paul Eggert  <eggert@cs.ucla.edu>

	* .gitignore: Add lib/unistr, lib/unused-parameter.h.

2011-08-10  Jim Meyering  <meyering@redhat.com>

	post-release administrivia
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* cfg.mk (old_NEWS_hash): Auto-update.

	version 3.1
	* NEWS: Record release date.

	build: use largefile module and update to latest gnulib
	* configure.ac: Remove AC_SYS_LARGEFILE, subsumed by ...
	* bootstrap.conf (gnulib_modules): ...this.  Use largefile module.
	* gnulib: Update to latest.

2011-08-08  Santiago Vila  <sanvila@unex.es>

	doc: insert comma in --help line for --ignore-space-change (-b)
	* src/diff.c (option_help_msgid): Insert omitted comma between
	"-b" and "--ignore-space-change".  (tiny change)

2011-08-04  Jim Meyering  <meyering@redhat.com>

	doc: relax restriction on front-cover and back-cover texts
	* doc/diffutils.texi (copying): Relax restriction on front-cover
	and back-cover texts (just as m4 did here:
	http://git.savannah.gnu.org/cgit/m4.git/commit?id=ee1e92ec).
	Reported by Santiago Vila.  Fix suggested by Eric Blake.

2011-08-03  Jim Meyering  <meyering@redhat.com>

	tests: update init.sh from gnulib
	* tests/init.sh: Update from gnulib.

	build: update gnulib submodule to latest

2011-07-03  Jim Meyering  <meyering@redhat.com>

	maint: remove inclusion of unused header, for "make syntax-check"
	* src/diff3.c: Don't include <inttostr.h>.  Not used.
	* src/context.c: Likewise.

2011-06-19  Jim Meyering  <meyering@redhat.com>

	build: don't require perl when building from a tarball
	But do ensure -- in all other circumstances -- that the man/*.1
	files are rebuilt whenever the version number changes.
	* configure.ac (SRC_VERSION_C): Define.
	* man/Makefile.am (dist_man1_MANS): Rename from $(man1_MANS),
	so that we distribute those pesky man/*.1 files.
	(EXTRA_DIST): Reflect name change.
	(MAINTAINERCLEANFILES): Define this, not DISTCLEANFILES,
	now that these generated files are distributed.
	($(dist_man1_MANS)): Depend on $(SRC_VERSION_C), so we get the
	full dependency when not building from a tarball.

2011-06-13  Jim Meyering  <meyering@redhat.com>

	doc: do not distribute generated man/*.1 man files
	* man/help2man: New file.
	* man/Makefile.am: Use $(srcdir)/help2man.
	Convert $(dist_man1_MANS) to $(man1_MANS), to tell automake
	not to distribute the generated man/*.1 files.  Now they're
	generated at build-from-tarball time.
	($(man1_MANS)): Depend on version.c, so that man pages are
	regenerated whenever the version string changes.

	build: ccache works better without embedded version strings
	* src/Makefile.am: Generate version.c and version.h and put the
	new symbol in a tiny library to be used by each program.
	(LDADD): Add the new library.
	* src/cmp.c (main): Use Version, not PACKAGE_VERSION, so the .o
	file does not change with each commit-derived version increment.
	* src/diff.c (main): Likewise.
	* src/diff3.c (main): Likewise.
	* src/sdiff.c (main): Likewise.
	* src/system.h: Include "version.h".
	* .gitignore: Add version.[ch]

2011-06-12  Jim Meyering  <meyering@redhat.com>

	doc: ensure each program has a man/*.x file: add "SEE ALSO" references
	* man/cmp.x: New file.
	* man/diff3.x: New file.
	* man/sdiff.x: New file.
	* man/diff.x: Add xrefs to the other three programs, and to patch.
	* man/Makefile.am (EXTRA_DIST): List new files.
	(cmp.1, diff3.1, sdiff.1): Depend on each .x file.

	doc: rename diff.texi to diffutils.texi
	This makes the .texi basename the same as the package name,
	which is consistent with most other GNU packages.
	* doc/diffutils.texi: Rename from...
	* doc/diff.texi: ...removed.
	* doc/Makefile.am (info_TEXINFOS): Reflect name change.
	(diffutils_TEXINFOS): Likewise.
	* cfg.mk (gendocs_options_): Remove this customization.  It is no
	longer needed, now that the .texi name matches that of the package.
	* man/Makefile.am ($(dist_man1_MANS)): Remove now-unnecessary sed
	filter.
	* README: Update references to diffutils.texi etc. here, too.
	* .gitignore: Update here, too.
	Suggested by Karl Berry.

2011-06-08  Karl Berry  <karl@freefriends.org>

	cmp, diff, diff3, sdiff: edit and align --help text.
	* cmp.c (option_help_msgid, usage),
	* diff.c (option_help_msgid, usage),
	* diff3.c (option_help_msgid, usage),
	* sdiff.c (option_help_msgid, usage): align descriptions in the --help
	output and slightly edit content.

2011-05-27  Paul Eggert  <eggert@cs.ucla.edu>

	diff: don't use locales after local-specific sorting fails
	* src/dir.c (compare_names): Don't invoke strcasecmp if
	locale-specific sorting fails, because POSIX.1-2008 says strcasecmp
	has unspecified behavior outside the POSIX locale.  See:
	http://lists.gnu.org/archive/html/bug-diffutils/2011-05/msg00008.html

	bootstrap: Avoid multithreading.
	* bootstrap.conf (gnulib_tool_option_extras):
	Add "--avoid=localename --avoid=lock", because we don't want to
	bring in the multithreading code that recent gnulib changes would
	otherwise bring in.
	(excluded_files): Remove m4/lock.m4; no longer needed, now that
	we use --avoid=lock.

	build: update gnulib submodule to latest

2011-05-23  Karl Berry  <karl@gnu.org>

	maint: update README-hacking
	* README-hacking: Update a la coreutils for git, etc.

2011-05-23  Jim Meyering  <meyering@redhat.com>

	maint: update gnulib to latest with accompanying tight-scope tweaks
	* cfg.mk: Include $(srcdir)/dist-check.mk using "-include",
	to accommodate the new sc_tight_scope rule.
	(_gl_TS_extern): Define, to tell gnulib's tight_scope rule that
	headers here mark externs with "XTERN".
	* gnulib: Update to latest.

2011-05-18  Jim Meyering  <meyering@redhat.com>

	maint: use gnulib's new readme-release module
	* bootstrap.conf (gnulib_modules): Add readme-release.
	(bootstrap_epilogue): Add the recommended perl one-liner.
	* README-release: Remove file; it is now generated from gnulib.
	* .gitignore: Add it.

	build: update gnulib submodule to latest

	maint: prepare for the tight-scope check
	* src/diff.h: Mark function declarations with "extern" in
	preparation for the tight-scope check.
	(ignore_white_space): Separate enum decl from declaration
	of this variable.
	* src/Makefile.am (diff_SOURCES): Move diff.h from here to ...
	(noinst_HEADERS): ...here.
	For convenience, since the tight-scope rule uses $(noinst_HEADERS).

	maint: don't use now-removed gnulib "exit" module
	* bootstrap.conf (gnulib_modules): Remove "exit" module.
	It no longer exists.

2011-03-26  Jim Meyering  <meyering@redhat.com>

	build: update gnulib submodule to latest

	* .x-sc_space_tab: Remove file.  Instead, ...
	* cfg.mk (exclude_file_name_regexp--sc_space_tab): ...define this.

	maint: fix typo in unused rule
	* cfg.mk (config-save): Fix typo: add leading "_" in variable name.

2011-03-18  Jim Meyering  <meyering@redhat.com>

	doc: add a reference to wdiff(1) from diff.1
	* man/diff.x: New file, to add "SEE ALSO" reference to wdiff(1).
	* man/Makefile.am (diff.1): Depend on diff.x.
	($(dist_man1_MANS)): Tell help2man to include diff.x.
	(EXTRA_DIST): Add diff.x.
	Suggestion from Dan Jacobson in http://bugs.debian.org/613319

2011-03-18  Eric Blake  <eblake@redhat.com>

	docs: info should mention -L
	* doc/diff.texi (diff Options): Document -L.

	docs: diff --help should mention -L
	* src/diff.c (option_help_msgid): Document -L.

2011-02-15  Jim Meyering  <meyering@redhat.com>

	doc: speak of the --test (-a) option, not "the -a or --test option"
	Convert using this command:
	perl -pi -e \
	  's/(\@option{-.}) or (\@option{--.*?}) option/$2 ($1) option/' \
	  doc/diff.texi
	Then convert some more with this:
	perl -pi -e \
	    's/the (\@option{-.}) or (\@option{--.*?})$/the $2 ($1)/' \
	  doc/diff.texi
	Then convert more manually.

	Suggested by Dan Jacobson

2011-01-24  Jim Meyering  <meyering@redhat.com>

	maint: remove all uses of vfork: use fork instead
	Our use of vfork now provokes warnings from gcc-4.6.0.
	Also, vfork is no longer even specified by POSIX.1-2008.
	* src/diff3.c (read_diff): Change each use of vfork to "fork".
	Remove #ifdef'd code.
	* src/util.c (begin_output, finish_output): Likewise.
	* src/sdiff.c (cleanup, main, edit): Likewise.
	(handler_index_of_SIGPIPE): Remove now-unused definition.
	* src/system.h: Don't include <vfork.h>.
	(vfork): Remove definition.
	* ms/config.site: Remove reference to vfork cache variable.

	tests: avoid newer but less-portable tail option syntax
	* tests/function-line-vs-leading-space: Use sed -n '3,$p' rather than
	tail -n+3.  Older versions of tail do not accept that newer syntax.
	Reported by Sudhakara Peram.

	tests: fix an erroneous test
	On most systems, like-named files were compared, by luck.
	However, on others, different-named files would be compared
	since their names were being treated as equal -- but they had
	different content, so the test would fail.
	* tests/colliding-file-names: Use different sets of file names
	in d1 and d2 so that they cannot accidentally match.
	Put the same line in each test file.  This is required
	when files named e.g., abc and ABC are compared.
	This test was failing on a NixOS 86_64-darwin system.

	build: update gnulib submodule to latest

	tests: fix typo that silently disabled all tests
	* tests/Makefile.am (TESTS): Fix typo: s/jESTS/TESTS/

2011-01-23  Jim Meyering  <meyering@redhat.com>

	build: update gnulib submodule to latest

	maint: avoid new syntax-check failure
	* src/diff.c (specify_value): Use !STREQ(...), not strcmp(...) != 0.
	* src/diff3.c (main): Likewise.

2011-01-03  Jim Meyering  <meyering@redhat.com>

	maint: update copyright year ranges to include 2011
	Run "make update-copyright", so "make syntax-check" works in 2011.

	build: update gnulib submodule to latest

2010-12-16  Paul Eggert  <eggert@cs.ucla.edu>

	bootstrap: adjust to recent gnulib changes
	* bootstrap.conf (excluded_files): Do not exclude m4/size_max.m4
	and m4/xsize.m4 when using an external gettext, since they are
	now needed by other gnulib modules.

2010-12-16  Jim Meyering  <meyering@redhat.com>

	doc: add contributor guidelines: HACKING
	* HACKING: New file, copied 99% from the one in grep's repository.

2010-10-09  Jim Meyering  <meyering@redhat.com>

	maint: describe policy on copyright year number ranges
	* README: Mention coreutils' long-standing policy on use of M-N
	ranges in copyright year lists.  Requested by Richard Stallman.

2010-09-04  Jim Meyering  <meyering@redhat.com>

	maint: adjust init.sh use to conform
	* tests/help-version: Use one line: "${srcdir=.}/init.sh"; ...
	* tests/basic: Likewise.
	* tests/binary: Likewise.
	* tests/colliding-file-names: Likewise.
	* tests/excess-slash: Likewise.
	* tests/function-line-vs-leading-space: Likewise.
	* tests/help-version: Likewise.
	* tests/label-vs-func: Likewise.
	* tests/no-newline-at-eof: Likewise.
	* tests/stdin: Likewise.

	maint: avoid shadowing warning
	* src/dir.c (diff_dirs): Rename shadowed local cmp to "c".

2010-09-03  Jim Meyering  <meyering@redhat.com>

	build: use gettext-h, not gettext
	* bootstrap.conf (gnulib_modules): Use gettext-h, not gettext.
	The latter is overkill for a package that uses
	AM_GNU_GETTEXT([external]...

	build: update build/test tools from gnulib
	* bootstrap: Update from gnulib.
	* tests/init.sh: Likewise.

	build: update gnulib submodule to latest

2010-08-14  Jim Meyering  <meyering@redhat.com>

	diff -r: avoid printing excess slashes in concatenated file names
	* bootstrap.conf (gnulib_modules): Add filenamecat.
	* src/diff.c: Include "filenamecat.h".
	(compare_files): Use file_name_concat, rather than dir_file_pathname.
	* src/util.c (dir_file_pathname): Remove now-unused function.
	* src/diff.h: Remove its declaration.
	* tests/excess-slash: New script to test for this.
	* tests/Makefile.am (TESTS): Add it.
	Forwarded by Santiago Vila from <bugs.debian.org/586301a>,
	reported by Jari Aalto.

2010-08-12  Paul Eggert  <eggert@cs.ucla.edu>

	diff: avoid spurious diffs when two distinct dir entries compare equal
	Problem reported by Christoph Anton Mitterer in:
	http://lists.gnu.org/archive/html/bug-diffutils/2010-08/msg00000.html

	* NEWS: Mention this bug fix.
	* src/dir.c (compare_names_for_qsort): Fall back on file_name_cmp
	if two distinct entries in the same directory compare equal.
	(diff_dirs): Prefer a file_name_cmp match when available.
	* tests/Makefile.am (TESTS): New test colliding-file-names.
	* tests/colliding-file-names: New file.

2010-05-09  Jim Meyering  <meyering@redhat.com>

	build: update gnulib submodule to latest

	build: don't define macros that gnulib provides
	* bootstrap.conf (gnulib_modules): Add signal, stdint.
	* lib/cmpbuf.c (SA_RESTART, SA_INTERRUPT): Remove definitions.
	(SIZE_MAX, PTRDIFF_MAX): Likewise.
	Include <stdint.h>.
	* src/system.h (WEXITSTATUS, WIFEXITED): Remove definitions.
	(SA_RESTART, SA_INTERRUPT): Likewise.

	build: rely on gnulib's sigprocmask module
	* src/sdiff.c: Remove #if-!HAVE_SIGPROCMASK-guarded code.
	* bootstrap.conf (gnulib_modules): Add sigprocmask.

2010-05-04  Jim Meyering  <meyering@redhat.com>

	doc: README-release: don't mention To:, Cc:, etc announcement headers,
	now that those are supplied automatically via gnulib's maint.mk.
	* README-release: sync with coreutils.

	maint: teach web-doc-generating code how to do its job
	* cfg.mk (gendocs_options): Define, so that gendocs.sh knows
	the name of our texinfo source file.
	* gnulib: Update to latest, for new gnu-web-doc-update and maint.mk.

2010-05-03  Jim Meyering  <meyering@redhat.com>

	doc: update release procedure
	* README-release: Rearrange slightly: post the announcement to
	Savannah first, so you can include a link to that post in the email.
	Sync a few details from coreutils' README-release.

	post-release administrivia
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* cfg.mk (old_NEWS_hash): Auto-update.

	version 3.0
	* NEWS: Record release date.

	build: update gnulib submodule to latest

2010-04-30  Jim Meyering  <meyering@redhat.com>

	build: use gnulib's sys_wait module
	* bootstrap.conf (gnulib_modules): Use gnulib's sys_wait module,
	now that we assume its presence.

	build: update gnulib submodule to latest
	* bootstrap: Also update from gnulib.
	* tests/init.sh: Likewise

	maint: remove now-useless #if HAVE_HEADER_H guards
	* src/system.h: Include <sys/wait.h> unconditionally,
	now that gnulib guarantees its presence.
	* lib/cmpbuf.c: Likewise for <unistd.h> and <inttypes.h>.

2010-04-16  Jim Meyering  <meyering@redhat.com>

	tests: use original no-newline-at-eof test, but with -U1, not -U2
	* tests/no-newline-at-eof: Revert to the smaller test, but with
	-U1 rather than -U2, since that actually triggers the bug.

2010-04-16  Paul Eggert  <eggert@cs.ucla.edu>

	Followon improvements for the fix for Debian bug 577832.
	* src/io.c (find_and_hash_each_line): Omit the inserted newline in
	a simpler way.
	* tests/no-newline-at-eof: Fix the test case so that it rejects
	the old, buggy behavior.

2010-04-16  Jim Meyering  <meyering@redhat.com>

	build: update gnulib submodule to latest

	tests: test for the no-newline-at-EOF bug
	* tests/no-newline-at-eof: New file.
	* tests/Makefile.am (TESTS): Add it.

2010-04-16  Jim Meyering  <meyering@redhat.com>

	diff: fix a regression when at least one input lacks a newline-at-EOF,
	and the final hunk plus context-length aligns exactly with the end
	of the newline-lacking file.  Diff would fail to output the required
	"\ No newline at end of file" line, thus rendering the output invalid.
	This bug appears to have been introduced by 2006-05-07
	commit 58d0483b, "(find_identical_ends): Fix huge performance bug...",
	at least to the extent that reverting that change fixes the bug.
	Considering the stated effect of that change and lack of metrics,
	reverting it is not an option, so here we take a more direct approach.

	Given these inputs,

	    printf '\n1'>a; printf '\n0\n\n1'>b

	and running diff like this:

	    ./diff -U1 a b

	for input file "b", the pointer, files[1].linbuf[4][-1], to
	the last byte on the final line was mistakenly pointing at the
	sentinel newline at EOF, rather than at the preceding byte.

	  (gdb) p files[1].linbuf[4][-1]
	  $3 = 10 '\n'

	Thus, this test in the final print_1_line call:

	  if ((!line_flag || line_flag[0]) && limit[-1] != '\n')
	    fprintf (out, "\n\\ %s\n", _("No newline at end of file"));

	would fail, because limit[-1] (which is files[1].linbuf[4][-1])
	was mistakenly '\n', rather than the desired '1'.

	My first thought was simply to adjust the final linbuf[line] setting,
	at the end of io.c's find_and_hash_each_line function function:

	       if (p == bufend)
	-       break;
	+       {
	+         if (current->missing_newline)
	+           --linbuf[line];
	+         break;
	+       }

	But that would make diff misbehave with this input
	(same as above, but with a newline appended to "a"),

	    printf '\n1\n'>a; printf '\n0\n\n1'>b
	    ./diff -U1 a b

	due to the block (100 lines above) that is triggered in that case
	(but not in the both-files-missing-newline case):

	      if (p == bufend
	          && current->missing_newline
	          && ROBUST_OUTPUT_STYLE (output_style))
	        {
	          /* This line is incomplete.  If this is significant,
	             put the line into buckets[-1].  */
	          if (ignore_white_space < IGNORE_SPACE_CHANGE)
	            bucket = &buckets[-1];

	          /* Omit the inserted newline when computing linbuf later.  */
	          p--;
	          bufend = suffix_begin = p;
	        }

	Note how "p" is decremented and "bufend" adjusted.
	When that happens, we certainly don't want to decrement
	"bufend" yet again.

	Since there is no other way to determine at the end whether "bufend"
	was already decremented, add a new variable to serve as witness.

	* NEWS (Bug fixes): Mention it.
	Reported by Timo Juhani Lindfors in http://bugs.debian.org/577832.
	Forwarded by Santiago Vila.

2010-04-16  Jim Meyering  <meyering@redhat.com>

	tests: update init.sh from gnulib
	* tests/init.sh: Update from gnulib.

2010-04-08  Jim Meyering  <meyering@redhat.com>

	build: include cfg.mk and dist-check.mk in the distribution tarball
	* Makefile.am (EXTRA_DIST): Add cfg.mk and dist-check.mk.

	maint: update to latest gnulib
	* cfg.mk (sc_cross_check_PATH_usage_in_tests): Remove rule,
	now that it's in gnulib's maint.mk.
	* gnulib: Update to latest.

2010-04-07  Jim Meyering  <meyering@redhat.com>

	tests: make new PATH-crosschecking syntax-check tighter
	* cfg.mk (sc_cross_check_PATH_usage_in_tests): Use grep's -x (match
	entire line) option with -F.

	tests: pull latest help-version from gzip
	* tests/help-version: Update from gzip.
	* Makefile.am (TESTS_ENVIRONMENT): Export VERSION,
	as required for this new help-version script.

	tests: add syntax-check rule to verify that tests use proper PATH
	* cfg.mk (sc_cross_check_PATH_usage_in_tests): New rule, that is
	useful only in conjunction with the help-version script.

	tests: use path_prepend_ consistently; remove unnecessary VERBOSE check
	* tests/basic: Likewise.
	* tests/binary: Likewise.
	* tests/function-line-vs-leading-space: Likewise.
	* tests/label-vs-func: Likewise.
	* tests/stdin: Likewise.

2010-04-06  Eric Blake  <eblake@redhat.com>

	maint: ignore generated files
	* .gitignore: Ignore recent gnulib additions.

	maint: update to latest bootstrap
	* bootstrap: Copy from gnulib/build-aux.

2010-04-05  Jim Meyering  <meyering@redhat.com>

	tests: get latest init.sh from gnulib
	* tests/init.sh: Update from gnulib.

	build: update gnulib submodule to latest; adapt
	* cfg.mk (local-checks-to-skip): Add new sc_texinfo_acronym, to skip it.

	diff -F/-p: don't depend on locale-specific white-space definition
	* src/context.c: Include "c-ctype.h".
	Use c_isspace, not isspace.

2010-03-18  Jim Meyering  <meyering@redhat.com>

	tests: exercise new behavior of -F RE
	* tests/function-line-vs-leading-space: New file.
	* tests/Makefile.am (TESTS): Add it.

2010-03-18  Yannick Moy  <yannick.moy@adacore.com>

	with -F or -p, emit better function lines: no leading white space
	* src/diff.c (print_context_function): For languages like Ada
	that allow local functions and procedures, the plain context
	function line may start with enough blank characters that the
	function name does not get completely printed in the 40
	characters limit.  This patch solves this problem by removing
	these useless initial blank characters.
	* NEWS (Changes in behavior): Mention this change.

2010-03-17  Jim Meyering  <meyering@redhat.com>

	build: don't require a specific version of help2man
	* bootstrap.conf (buildreq): Bootstrap can't deal with it,
	perhaps because the command name contains a digit.

	build: make bootstrap ensure that help2man is available
	* bootstrap.conf (buildreq): Add help2man.

2010-02-23  Jim Meyering  <meyering@redhat.com>

	tests: test for the "Binary files A and B differ" diagnostic
	* tests/binary: New script.
	* tests/Makefile.am (TESTS): Add it.

	revert 2002 change that removed "Binary " from "files A and B differ"
	With this change, "printf '\0'|diff - /dev/null" now prints
	"Binary files - and /dev/null differ" once again.
	This reverts 2002-06-28 commit a352f0980,
	"(briefly_report): Don't say "Binary files differ", ...".
	* src/analyze.c (briefly_report): Do include the "Binary " prefix
	in the diagnostic, when !brief.
	* NEWS (Changes in behavior): Mention the diagnostic change.
	Reported by Andreas Hoenen in http://bugs.debian.org/570064.

2010-02-14  Juan Manuel Guerrero  <juan.guerrero@gmx.de>

	avoid compilation failure on systems lacking both fork and vfork
	* src/sdiff.c [!HAVE_WORKING_FORK && !HAVE_WORKING_VFORK] (main):
	Pass the right number of arguments to shell_quote_copy.
	* src/util.c [!HAVE_WORKING_FORK && !HAVE_WORKING_VFORK] (begin_output):
	Likewise.

2010-02-11  Jim Meyering  <meyering@redhat.com>

	post-release administrivia
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* cfg.mk (old_NEWS_hash): Auto-update.

	version 2.9
	* NEWS: Record release date.

	doc: document the release procedure
	* README-release: New file.

2010-02-10  Jim Meyering  <meyering@redhat.com>

	maint: change use of "|" to more maintainable "||" (no semantic change)
	* src/analyze.c (diff_2_files): Using the "||" operator happens to
	be equivalent to using "|" in this case.  It is also clearer and
	less prone to inadvertent bug introduction, in case the variable,
	"changes" were ever to take on a value not in {0,1}.
	Patch by Tim Waugh, via Mike Frysinger.

	portability: avoid "diff - ..." failure at least on *BSD and Solaris
	The new "stdin" test was failing on many types of systems.
	* src/diff.c (compare_files): Guard use of xfreopen (NULL, "rb", ...
	also with O_BINARY, so as to avoid this unnecessary call on
	systems where it's not needed (on some it fails with "Bad address".

2010-02-09  Jim Meyering  <meyering@redhat.com>

	tests: honor VERBOSE
	* tests/basic: Enable "set -x" if $VERBOSE.
	* tests/help-version: Likewise.
	* tests/label-vs-func: Likewise.
	* tests/stdin: Likewise.

2010-02-04  Jim Meyering  <meyering@redhat.com>

	build: update gnulib submodule to latest

	sync with gnulib
	* gl/lib/regcomp.c.diff: Adjust to apply to the latest in gnulib.
	* gnulib: Update submodule to latest.

2010-02-04  Jim Meyering  <meyering@redhat.com>

	build: do not override gnulib-provided AM_CFLAGS options
	Avoid a warning from automake:
	lib/Makefile.am:23: AM_CFLAGS multiply defined in condition TRUE ...
	lib/gnulib.mk:30: ... `AM_CFLAGS' previously defined here
	lib/Makefile.am:18:   `lib/gnulib.mk' included from here

	* lib/Makefile.am (AM_CFLAGS): Append $(WARN_CFLAGS) and
	$(WERROR_CFLAGS), i.e., use "+=", not "=".
	This was introduced via 2009-12-17 commit e58efa5b
	"build: enable warnings and -Werror.",
	but fortunately is not a bug, because the definition
	it would have overridden was always empty.

2010-01-17  Jim Meyering  <meyering@redhat.com>

	maint: add to .gitignore
	* .gitignore: Ignore more.

2010-01-15  Jim Meyering  <meyering@redhat.com>

	doc: add to TODO
	* TODO: Add an item, suggested by Dan Jacobson.

2010-01-13  Jim Meyering  <meyering@redhat.com>

	tests: ensure that an argument of "-" is treated as standard input
	* tests/stdin: New test.
	* tests/Makefile.am (TESTS): Add it.

2010-01-10  Jim Meyering  <meyering@redhat.com>

	tests: now "make distcheck" runs more tests, incl. syntax-check
	* cfg.mk: Include dist-check.mk, from coreutils.
	* Makefile.am (distcheck-hook): Define rule, to hook to...
	* dist-check.mk: New file.

2010-01-09  Jim Meyering  <meyering@redhat.com>

	build: update gnulib to latest, for fixed syntax-check rule

	maint: record updated NEWS hash
	* cfg.mk (old_NEWS_hash): Update to account for GFDL change.

	build: update gnulib submodule to latest

	tests: add a test of basic functionality
	* tests/basic: Start adding tests.
	* tests/Makefile.am (TESTS): Add it.

	maint: udpate GFDL license to 1.3
	* doc/diff.texi: Update to use GFDL version 1.3.

2010-01-04  Eric Blake  <ebb9@byu.net>

	build: allow compilation on cygwin
	* src/Makefile.am (cmp_LDADD): Move LIBICONV...
	(LDADD): ...into global flags, since all programs need it.

2010-01-03  Jim Meyering  <meyering@redhat.com>

	maint: record update-copyright options for this package
	* cfg.mk: Next time, just run "make update-copyright".

	tests: prepend ../src, not "." to PATH
	* tests/help-version: Correct PATH.

2010-01-01  Jim Meyering  <meyering@redhat.com>

	maint: update all FSF copyright year lists to include 2010
	Use this command:
	git ls-files |grep -vE '^(\..*|COPYING|gnulib)$' |xargs \
	env UPDATE_COPYRIGHT_USE_INTERVALS=1 build-aux/update-copyright

2009-12-31  Jim Meyering  <meyering@redhat.com>

	maint: newer gnulib; don't hard-code my GPG key ID
	* cfg.mk (gpg_key_ID): Remove definition, now that maint.mk automates it.
	* gnulib: Update to latest.

	tests: exercise diff -p's function-name matching
	* tests/label-vs-func: New file.
	* tests/Makefile.am (TESTS): Add label-vs-func.
	Reported by Simon Arlott <simon@fire.lp0.eu>
	http://article.gmane.org/gmane.linux.kernel.janitors/14260

	tests: use gnulib's init.sh
	* tests/Makefile.am (EXTRA_DIST): Add init.sh.
	Remove test-lib.sh.
	* tests/init.sh: New file.
	* tests/test-lib.sh: Remove file.
	* tests/help-version: Use init.sh, not test-lib.sh.

2009-11-28  Jim Meyering  <meyering@redhat.com>

	maint: don't let trailing spaces in diffs perturb make syntax-check
	* .x-sc_space_tab: New file.

2009-11-22  Jim Meyering  <meyering@redhat.com>

	build: enable warnings and -Werror.
	* src/Makefile.am (AM_CFLAGS): Enable warnings and -Werror.
	Set to this: $(WARN_CFLAGS) $(WERROR_CFLAGS)
	* lib/Makefile.am (AM_CFLAGS): Similarly, but use this:
	$(GNULIB_WARN_CFLAGS) $(WERROR_CFLAGS)
	* configure.ac (GNULIB_WARN_CFLAGS): Don't turn off -Wuninitialized.

	build: avoid a warning from gnulib's sh-quote.c
	* gl/lib/sh-quote.c.diff: New file, to avoid a warning.

	maint: avoid warnings via patched versions of gnulib's regex functions
	* gl/lib/regcomp.c.diff: New file.
	* gl/lib/regex_internal.c.diff: Likewise.
	* gl/lib/regex_internal.h.diff: Likewise.
	* gl/lib/regexec.c.diff: Likewise.

	build: update gnulib submodule to latest

2009-11-20  Eric Blake  <ebb9@byu.net>

	build: ignore more files
	* .gitignore: Add config.cache, *.exe.

2009-11-20  Eric Blake  <ebb9@byu.net>

	build: fix test run on cygwin
	This, plus a gnulib update for xalloc-die-tests, are necessary
	for make check to pass on cygwin.

	* tests/Makefile.am (built_programs): Ignore $(EXEEXT).
	* src/Makefile.am (paths.h): Add missing dependency.

2009-11-20  Jim Meyering  <meyering@redhat.com>

	maint: remove vestiges of nanosleep
	* src/Makefile.am (LDADD): Remove $(LIB_NANOSLEEP), now
	that we no longer use the nanosleep module.
	Spotted by Eric Blake.

	maint: don't pull in gnulib's nanosleep unnecessarily
	* bootstrap.conf (gnulib_modules): Remove nanosleep.  Not needed.
	Spotted by Eric Blake.

	maint: cfg.mk: remove factored-out ftp host/dir definitions
	* cfg.mk (gnu_ftp_host-alpha, gnu_ftp_host-beta gnu_ftp_host-stable):
	(gnu_rel_host, url_dir_list): Remove definitions.  The defaults,
	now provided by maint.mk, are the same.
	* gnulib: Update for latest, including those maint.mk additions.

	build: link with now-required libraries
	* src/Makefile.am (LDADD): Add gnulib-required libraries.
	(cmp_LDADD): Add $(LIBICONV), for cmp's use of proper_name_utf8.

	maint: lib/xfreopen.c contains translatable strings
	* po/POTFILES.in: Add lib/xfreopen.c.

	maint: remove hard-coded macro definitions provided by intprops.h
	* lib/cmpbuf.c: Include "intprops.h" rather than open-coding macros
	like TYPE_SIGNED and TYPE_MINIMUM.

	maint: add gnulib's announce-gen module
	* bootstrap.conf (gnulib_modules): Add announce-gen

	build: suppress warnings about bindtextdomain and textdomain
	* src/system.h (bindtextdomain, textdomain) [!ENABLE_NLS]: Define away.

	build: use more gnulib modules
	* bootstrap.conf (gnulib_modules): Add mktime, nanosleep, strptime
	and timegm.

	use xfreopen rather than freopen
	* src/cmp.c: Include "xfreopen.h".
	Use xfreopen in place of freopen.
	* src/diff.c Likewise, and...
	(main): Set exit_failure to EXIT_TROUBLE, rather than to 2.
	* src/diff3.c: Likewise.
	* bootstrap.conf (gnulib_modules): Add xfreopen.

	build: enable many warnings
	* configure.ac: Add support for --enable-gcc-warnings.
	* bootstrap.conf (gnulib_modules): Add manywarnings.
	* Makefile.am (AM_CFLAGS): Add $(WARN_CFLAGS) $(WERROR_CFLAGS)

	build: update gnulib submodule to latest

	maint: add an assertion to suppress clang-detected warning
	The clang static analyzer reported that a NULL parent could be
	dereferenced.  However, that cannot happen, because for all callers,
	the parameter, parent, is always non-NULL at that point.
	* src/diff.c: Include <assert.h>.
	Assert that parent is not NULL.

	maint: remove dead assignment from diff3.c
	* src/diff3.c (make_3way_diff): Remove dead assignment.

2009-11-17  Jim Meyering  <meyering@redhat.com>

	build: update gnulib submodule to latest

	maint: hide build commands behind $(AM_V_GEN)
	* src/Makefile.am (paths.h): Use $(AM_V_GEN), and split a long line.
	* man/Makefile.am ($(dist_man1_MANS)): Use $(AM_V_GEN) here, too.

2009-11-16  Jim Meyering  <meyering@redhat.com>

	build: let automake generate better man-installation rules
	* man/Makefile.am (dist_man1_MANS): Rename from dist_man_MANS,
	to enable better automake-generated installation rules.

	admin: ignore all of gnulib-tests
	* .gitignore: Add gnulib-tests

2009-11-16  Eric Blake  <ebb9@byu.net>

	build: avoid link failure when libsigsegv is used
	* src/Makefile.am (LDADD): Link against LIBSIGSEGV.

2009-11-16  Jim Meyering  <meyering@redhat.com>

	maint: define/use PROGRAM_NAME and AUTHORS; use propername module
	* bootstrap.conf (gnulib_modules): Add propername.
	* src/cmp.c (PROGRAM_NAME, AUTHORS): Define.
	(main): Use them in use of version_etc.
	* src/diff.c (PROGRAM_NAME, AUTHORS, main): Likewise.
	* src/diff3.c (PROGRAM_NAME, AUTHORS, main): Likewise.
	* src/sdiff.c (PROGRAM_NAME, AUTHORS, main): Likewise.
	* src/system.h: Include "propername.h".

	maint: no longer define *_FILENO constants
	* src/system.h (STDIN_FILENO, STDOUT_FILENO, STDERR_FILENO):
	Remove definitions.  Now guaranteed by gnulib.

	maint: bug-diffutils@gnu.org is the new bug-reporting address
	* configure.ac (AC_INIT): Use bug-diffutils@..., not bug-gnu-utils
	as the bug-reporting address.
	* NEWS (Administrivia): Mention this.
	* src/cmp.c (usage): Remove hard-coded address.
	Instead, use gnulib's emit_bug_reporting_address function.
	* src/diff.c (usage, option_help_msgid): Likewise.
	* src/diff3.c (usage): Likewise.
	* src/sdiff.c (usage): Likewise.

	sdiff, diff3: exec diff, not $(bindir)/diff
	* src/Makefile.am (paths.h): Emit a definition of DEFAULT_DIFF_PROGRAM
	that is simply "diff" (or whatever $(transform) would convert that to,
	e.g., "gdiff").  This makes it so that tests can work without first
	installing diff, and so that the binaries do not hard-code $(prefix).
	* NEWS (Changes in behavior): Mention this.

2009-11-14  Jim Meyering  <meyering@redhat.com>

	tests: add the first script; hook up gnulib-tests
	* configure.ac (AC_CONFIG_FILES): Add tests/Makefile and
	gnulib-tests/Makefile.
	* tests/help-version: New file, from coreutils.
	* tests/test-lib.sh: Likewise.
	* tests/Makefile.am: New file, from gzip.
	* Makefile.am (SUBDIRS): Add tests and gnulib-tests.
	* tests/t-local.sh: New, empty(for now) file.

2009-11-13  Jim Meyering  <meyering@redhat.com>

	build: require gettext-0.17
	* configure.ac: Require gettext-0.17; it was released two years ago.

	build: correct gettext configure-time support
	* configure.ac: Use AM_GNU_GETTEXT([external], [need-ngettext]),
	rather than AM_GNU_GETTEXT([external], [need-formatstring-macros]).
	Reported by Martin Jacobs in
	http://thread.gmane.org/gmane.comp.parsers.bison.bugs/3181

2009-11-12  Jim Meyering  <meyering@redhat.com>

	build: generalize autoheader check
	* bootstrap: Look for AC_CONFIG_HEADER as well as AC_CONFIG_HEADERS.

2009-11-11  Jim Meyering  <meyering@redhat.com>

	maint: use a git submodule for gnulib
	* .gitmodules: New file, to track gnulib.
	* gnulib: New file, created by running this:
	git submodule add git://git.sv.gnu.org/gnulib.git gnulib

	maint: tell git what it can ignore
	* .gitignore: Ignore generated files.
