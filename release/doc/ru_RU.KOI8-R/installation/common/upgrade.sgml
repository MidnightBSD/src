<!--
	The FreeBSD Russian Documentation Project

	$FreeBSD: src/release/doc/ru_RU.KOI8-R/installation/common/upgrade.sgml,v 1.3 2004/09/10 13:56:41 den Exp $
	$FreeBSDru: frdp/release/doc/ru_RU.KOI8-R/installation/common/upgrade.sgml,v 1.3 2004/09/06 14:05:03 den Exp $

	Original revision: 1.13

	This section contains the contents of the old UPGRADE.TXT
	file.
-->
<sect1 id="upgrading">
  <title>Обновление &os;</title>

  <para>Эта инструкция описывает процедуру бинарного обновления с
    предыдущих версий &os;.</para>

  <warning>
    <para>Хотя процедура обновления &os; предпринимает все меры
      для предотвращения потери данных, все еще более чем возможно
      <emphasis>потерять все содержимое жесткого диска</emphasis>
      во время обновления!  Пожалуйста, не подтверждайте установку
      без наличия резервной копии всех важных файлов.</para>
  </warning>

  <important>
    <para>Здесь предполагается, что вы используете
      &man.sysinstall.8;, поставляемую с той версией &os;, до которой вы
      хотите обновиться.  Использование другой версии &man.sysinstall.8;
      это почти гарантия возникновения проблем, система будет приведена
      в неработоспособное состояние.  Наиболее часто совершаемая в этом
      случае ошибка &mdash; это использование старой копии &man.sysinstall.8;
      из существующей системы для обновления &os; до новой версии.
      Это <emphasis>не</emphasis> рекомендуется.</para>
  </important>

  <warning>
    <para>Бинарное обновление до &os; &release.current; с &os; 4-STABLE
      на данный момент не поддерживается.  В &os; 4-STABLE есть несколько
      файлов, наличие которых может быть разрушительно, но они не удаляются
      бинарным обновлением.  Один известный пример это старый каталог
      <filename>/usr/include/g++</filename>, наличие которого приводит
      неправильной компиляции C++ программ (или они не компилируются
      вообще).</para>

    <para>Эти инструкции по обновлению предоставляются для пользователей,
      обновляющихся с относительно свежих &os; &release.branch;
      снэпшотов.</para>
  </warning>

  <sect2>
    <title>Введение</title>

    <para>Процедура обновления заменяет выбранные пользователем
      дистрибутивные наборы на наборы из нового релиза &os;.
      Она сохраняет файлы настройки системы, как и данные пользователя,
      установленные пакеты и другое программное обеспечение.</para>

    <para>Администраторам, выполняющим обновление, предлагается изучить
      этот раздел полностью перед началом обновления.</para>

    <sect3>
      <title>Обзор обновления</title>

      <para>Обновление дистрибутива производится путем извлечения новой
	версии компонентов поверх предыдущей версии.  Файлы, принадлежащие
	старому дистрибутиву, не удаляются.</para>

      <para>Настройки системы сохраняются путем сохранения и восстановления
	предыдущей версии следующих файлов:</para>

      <para><filename>Xaccel.ini</filename>,
<filename>XF86Config</filename>,
<filename>adduser.conf</filename>,
<filename>aliases</filename>,
<filename>aliases.db</filename>,
<filename>amd.map</filename>,
<filename>crontab</filename>,
<filename>csh.cshrc</filename>,
<filename>csh.login</filename>,
<filename>csh.logout</filename>,
<filename>cvsupfile</filename>,
<filename>dhclient.conf</filename>,
<filename>disktab</filename>,
<filename>dm.conf</filename>,
<filename>dumpdates</filename>,
<filename>exports</filename>,
<filename>fbtab</filename>,
<filename>fstab</filename>,
<filename>ftpusers</filename>,
<filename>gettytab</filename>,
<filename>gnats</filename>,
<filename>group</filename>,
<filename>hosts</filename>,
<filename>hosts.allow</filename>,
<filename>hosts.equiv</filename>,
<filename>hosts.lpd</filename>,
<filename>inetd.conf</filename>,
<filename>localtime</filename>,
<filename>login.access</filename>,
<filename>login.conf</filename>,
<filename>mail</filename>,
<filename>mail.rc</filename>,
<filename>make.conf</filename>,
<filename>manpath.config</filename>,
<filename>master.passwd</filename>,
<filename>motd</filename>,
<filename>namedb</filename>,
<filename>networks</filename>,
<filename>newsyslog.conf</filename>,
<filename>nsmb.conf</filename>,
<filename>nsswitch.conf</filename>,
<filename>pam.conf</filename>,
<filename>passwd</filename>,
<filename>periodic</filename>,
<filename>ppp</filename>,
<filename>printcap</filename>,
<filename>profile</filename>,
<filename>pwd.db</filename>,
<filename>rc.conf</filename>,
<filename>rc.conf.local</filename>,
<filename>rc.firewall</filename>,
<filename>rc.local</filename>,
<filename>remote</filename>,
<filename>resolv.conf</filename>,
<filename>rmt</filename>,
<filename>sendmail.cf</filename>,
<filename>sendmail.cw</filename>,
<filename>services</filename>,
<filename>shells</filename>,
<filename>skeykeys</filename>,
<filename>spwd.db</filename>,
<filename>ssh</filename>,
<filename>syslog.conf</filename>,
<filename>ttys</filename>,
<filename>uucp</filename>
</para>

      <para>Версии этих файлов, соответствующие новой версии системы,
	перемещаются в <filename>/etc/upgrade/</filename>.
	Системный администратор может объединить эти версии если
	требуется.  Обратите внимание, что многие из этих файлов
	взаимно зависимы, и лучшая процедура объединения &mdash; это
	копирование специфичных данных из старых версий файлов в
	новые.</para>

      <para>Во время процедуры обновления у администратора запрашивается
	место для сохранения файлов из <filename>/etc/</filename>.
	Если в используемые файлы будут внесены изменения, они могут
	быть последовательно восстановлены из этого каталога.</para>

    </sect3>
  </sect2>

  <sect2>
    <title>Процедура</title>

    <para>Этот раздел описывает детали процедуры обновления.
      Особое внимание уделено моментам, которые существенно
      отличаются от обычной установки.</para>

    <sect3>
      <title>Резервное копирование</title>

      <para>Данные пользователей и настройки системы должны быть
	сохранены перед обновлением.  Хотя процедура обновления делает
	все для предотвращения случайных ошибок, возможно частичное
	или полное уничтожение данных и настроечной информации.</para>
    </sect3>

    <sect3>
      <title>Монтирование файловых систем</title>

      <para>Запускается редактор дисковых разделов со списком устройств
	имеющихся файловых систем.  Перед началом обновления
	администратор должен обратить внимание имена устройств и
	соответствующие точки монтирования.  Эти точки монтирования
	должны быть введены здесь.  <emphasis>Не</emphasis>
	устанавливайте <quote>newfs flag</quote> для файловых систем,
	поскольку это приведет к потере данных.</para>
    </sect3>

    <sect3>
      <title>Выбор дистрибутивных наборов</title>

      <para>На выбор дистрибутивных наборов не накладывается ограничений.
	Общее правило состоит в том, что для обновления должен быть выбран
	дистрибутивный набор <literal>base</literal>, и <literal>man</literal>
	если страницы справочника уже установлены.  Другие дистрибутивные
	наборы могут быть позже, если администратор захочет добавить
	дополнительные возможности.</para>
    </sect3>

    <sect3 id="fstab">
      <title>После установки</title>

      <para>После завершения процедуры установки администратору предлагается
	проверить новые файлы настройки.  В этот момент должна быть выполнена
	проверка правильности настроек системы.  В частности, необходимо
	проверить файлы <filename>/etc/rc.conf</filename> и
	<filename>/etc/fstab</filename>.</para>
    </sect3>
  </sect2>

  <sect2>
    <title>Обновление из исходных текстов</title>

    <para>Для тех, кто интересуется более гибким и
      <quote>интеллектуальным</quote> методом обновления, существует глава
      Руководства &os; <ulink
      url="&url.books.handbook;/cutting-edge.html">На
      переднем крае разработок</ulink>.  Эта процедура относится к
      пересборке &os; из исходных текстов.  Она требует хорошего
      сетевого подключения, свободного места на диске и времени,
      но имеет преимущества при сетевых и других более сложных установках.
      Это та же процедура, что используется для отслеживания ветвей
      разработки -STABLE или -CURRENT.</para>

    <para><filename>/usr/src/UPDATING</filename> содержит важную
      информацию по обновлению системы &os; из исходных текстов.
      В нем отражены различные вопросы, относящиеся к изменениям в
      &os;, которые могут повлиять на обновление.</para>
  </sect2>
</sect1>
